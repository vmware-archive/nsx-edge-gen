<edge>
    <id>{{edge['id']}}</id>
    <description>Edge {{edge['name']}}</description>
    <datacenterMoid>{{edge['datacenter_id']}}</datacenterMoid>
    <name>{{edge['name']}}</name>
    <type>{{edge['type']}}</type>
    <fqdn>NSX-{{edge['id']}}</fqdn>
    <enableAesni>true</enableAesni>
    <enableFips>false</enableFips>
    <vseLogLevel>emergency</vseLogLevel>
    <vnics>
        <vnic>
            <index>0</index>
            <name>Lif to Uplink</name>
            <type>uplink</type> 
            <portgroupId>{{ uplink['id']}}</portgroupId>
            <addressGroups>
                <addressGroup>
                    <primaryAddress>{{uplink['primary_ip']}}</primaryAddress>
                    <secondaryAddresses>
                    {% for secondary_ip in uplink['secondary_ips']%}
                    <ipAddress>{{secondary_ip}}</ipAddress>
                    {% endfor %}
                    </secondaryAddresses>                
                    <subnetMask>{{uplink['netmask']}}</subnetMask>
                    <subnetPrefixLength>{{uplink['cidr']}}</subnetPrefixLength>
                </addressGroup>
            </addressGroups>           
            <mtu>1500</mtu>
            <enableProxyArp>false</enableProxyArp>
            <enableSendRedirects>true</enableSendRedirects>
            <isConnected>true</isConnected>
            <inShapingPolicy>
                <averageBandwidth>2000</averageBandwidth>
                <peakBandwidth>2000</peakBandwidth>
                <burstSize>0</burstSize>
                <enabled>true</enabled>
                <inherited>false</inherited>
            </inShapingPolicy>
            <outShapingPolicy>
                <averageBandwidth>2000</averageBandwidth>
                <peakBandwidth>2000</peakBandwidth>
                <burstSize>0</burstSize>
                <enabled>true</enabled>
                <inherited>false</inherited>
            </outShapingPolicy>
        </vnic>
        {% for lswitch in logical_switches %}
        <vnic>
            <index>{{ loop.index + 1}}</index>
            <name>Link to {{ lswitch['name']}}</name>
            <type>internal</type>
            <portgroupId>{{ lswitch['id']}}</portgroupId>
            <addressGroups>
                <addressGroup>
                    <primaryAddress>{{lswitch['primary_ip']}}</primaryAddress>
                    <secondaryAddresses>
                    {% for secondary_ip in lswitch['secondary_ips']%}
                    <ipAddress>{{secondary_ip}}</ipAddress>
                    {% endfor %}
                    </secondaryAddresses>
                
                    <subnetMask>{{lswitch['netmask']}}</subnetMask>
                    <subnetPrefixLength>{{lswitch['cidr']}}</subnetPrefixLength>
                </addressGroup>
            </addressGroups>
            <mtu>1500</mtu>
            <enableProxyArp>false</enableProxyArp>
            <enableSendRedirects>false</enableSendRedirects>
            <isConnected>true</isConnected>       
        </vnic>
        {% endfor %}

        {% for index in empty_logical_switch_seq %}
        <vnic>
            <index>{{ index }}</index>
            <label>vNic_{{ index}}</label>
            <name>vnic{{ index}}</name>
            <addressGroups/>
            <mtu>1500</mtu>
            <type>internal</type>
            <isConnected>false</isConnected>
            <index>3</index>
            <enableProxyArp>false</enableProxyArp>
            <enableSendRedirects>true</enableSendRedirects>
        </vnic>
        {% endfor %}
    </vnics>
    <appliances>
        <applianceSize>xlarge</applianceSize>
        <appliance>
            <highAvailabilityIndex>0</highAvailabilityIndex>
            <vcUuid>503fdb07-54ea-f49a-ed36-906b03b27602</vcUuid>
            <vmId>vm-1067</vmId>
            <resourcePoolId>domain-c261</resourcePoolId>
            <resourcePoolName>Cluster_New_edge</resourcePoolName>
            <datastoreId>datastore-17</datastoreId>
            <datastoreName>NFS_Shared</datastoreName>
            <hostId>host-362</hostId>
            <hostName>10.114.216.164</hostName>
            <vmFolderId>group-v3</vmFolderId>
            <vmFolderName>vm</vmFolderName>
            <vmHostname>NSX-edge-26-0</vmHostname>
            <vmName>PCF_new_edge-0</vmName>
            <deployed>true</deployed>
            <cpuReservation>
                <reservation>6000</reservation>
            </cpuReservation>
            <memoryReservation>
                <reservation>8192</reservation>
            </memoryReservation>
            <edgeId>edge-26</edgeId>
            <configuredResourcePool>
                <id>domain-c261</id>
                <name>Cluster_New_edge</name>
                <isValid>true</isValid>
            </configuredResourcePool>
            <configuredDataStore>
                <id>datastore-17</id>
                <name>NFS_Shared</name>
                <isValid>true</isValid>
            </configuredDataStore>
        </appliance>
        <deployAppliances>true</deployAppliances>
    </appliances>
    <cliSettings>
        <remoteAccess>false</remoteAccess>
        <userName>admin</userName>
        <sshLoginBannerText>
***************************************************************************
NOTICE TO USERS

This computer system is the private property of its owner, whether
individual, corporate or government.  It is for authorized use only.
Users (authorized or unauthorized) have no explicit or implicit
expectation of privacy.

Any or all uses of this system and all files on this system may be
intercepted, monitored, recorded, copied, audited, inspected, and
disclosed to your employer, to authorized site, government, and law
enforcement personnel, as well as authorized officials of government
agencies, both domestic and foreign.

By using this system, the user consents to such interception, monitoring,
recording, copying, auditing, inspection, and disclosure at the
discretion of such personnel or officials.  Unauthorized or improper use
of this system may result in civil and criminal penalties and
administrative or disciplinary action, as appropriate. By continuing to
use this system you indicate your awareness of and consent to these terms
and conditions of use. LOG OFF IMMEDIATELY if you do not agree to the
conditions stated in this warning.
****************************************************************************
</sshLoginBannerText>
        <passwordExpiry>99999</passwordExpiry>
    </cliSettings>
    <features>
        <l2Vpn>
            <version>7</version>
            <enabled>false</enabled>
            <logging>
                <enable>true</enable>
                <logLevel>notice</logLevel>
            </logging>
        </l2Vpn>
        <featureConfig/>
        <firewall>
            <version>7</version>
            <enabled>true</enabled>
            <globalConfig>
                <tcpPickOngoingConnections>false</tcpPickOngoingConnections>
                <tcpAllowOutOfWindowPackets>false</tcpAllowOutOfWindowPackets>
                <tcpSendResetForClosedVsePorts>true</tcpSendResetForClosedVsePorts>
                <dropInvalidTraffic>true</dropInvalidTraffic>
                <logInvalidTraffic>false</logInvalidTraffic>
                <tcpTimeoutOpen>30</tcpTimeoutOpen>
               <tcpTimeoutEstablished>21600</tcpTimeoutEstablished>
                <tcpTimeoutClose>30</tcpTimeoutClose>
                <udpTimeout>60</udpTimeout>
                <icmpTimeout>10</icmpTimeout>
                <icmp6Timeout>10</icmp6Timeout>
                <ipGenericTimeout>120</ipGenericTimeout>
                <enableSynFloodProtection>false</enableSynFloodProtection>
            </globalConfig>
            <defaultPolicy>
                <action>accept</action>
                <loggingEnabled>true</loggingEnabled>
            </defaultPolicy>
            <firewallRules>
                <firewallRule>
                    <id>131074</id>
                    <ruleTag>131074</ruleTag>
                    <name>firewall</name>
                    <ruleType>internal_high</ruleType>
                    <enabled>true</enabled>
                    <loggingEnabled>false</loggingEnabled>
                    <description>firewall</description>
                    <action>accept</action>
                    <source>
                        <exclude>false</exclude>
                        <vnicGroupId>vse</vnicGroupId>
                    </source>
                </firewallRule>
                <firewallRule>
                    <id>131076</id>
                    <ruleTag>131076</ruleTag>
                    <name>dns</name>
                    <ruleType>internal_high</ruleType>
                    <enabled>true</enabled>
                    <loggingEnabled>false</loggingEnabled>
                    <description>dns</description>
                    <action>accept</action>
                    <source>
                        <exclude>false</exclude>
                        <vnicGroupId>internal</vnicGroupId>
                    </source>
                    <destination>
                        <exclude>false</exclude>
                        <ipAddress>172.16.80.1</ipAddress>
                        <ipAddress>172.16.90.1</ipAddress>
                    </destination>
                    <application>
                        <service>
                            <protocol>udp</protocol>
                            <port>53</port>
                            <sourcePort>any</sourcePort>
                        </service>
                        <service>
                            <protocol>tcp</protocol>
                            <port>53</port>
                            <sourcePort>any</sourcePort>
                        </service>
                    </application>
                </firewallRule>
                <firewallRule>
                    <id>131073</id>
                    <ruleTag>131073</ruleTag>
                    <name>default rule for ingress traffic</name>
                    <ruleType>default_policy</ruleType>
                    <enabled>true</enabled>
                    <loggingEnabled>true</loggingEnabled>
                    <description>default rule for ingress traffic</description>
                    <action>accept</action>
                </firewallRule>
            </firewallRules>
        </firewall>
        <sslvpnConfig>
            <version>7</version>
            <enabled>false</enabled>
            <logging>
                <enable>true</enable>
                <logLevel>notice</logLevel>
            </logging>
            <advancedConfig>
                <enableCompression>false</enableCompression>
                <forceVirtualKeyboard>false</forceVirtualKeyboard>
                <randomizeVirtualkeys>false</randomizeVirtualkeys>
                <preventMultipleLogon>false</preventMultipleLogon>
                <clientNotification></clientNotification>
                <enablePublicUrlAccess>false</enablePublicUrlAccess>
                <timeout>
                   <forcedTimeout>0</forcedTimeout>
                    <sessionIdleTimeout>10</sessionIdleTimeout>
                </timeout>
            </advancedConfig>
            <clientConfiguration>
                <autoReconnect>true</autoReconnect>
                <upgradeNotification>false</upgradeNotification>
            </clientConfiguration>
            <layoutConfiguration>
                <portalTitle>VMware</portalTitle>
                <companyName>VMware</companyName>
                <logoExtention>jpg</logoExtention>
                <logoUri>/api/4.0/edges/edge-26/sslvpn/config/layout/images/portallogo</logoUri>
                <logoBackgroundColor>56A2D4</logoBackgroundColor>
                <titleColor>996600</titleColor>
                <topFrameColor>000000</topFrameColor>
                <menuBarColor>999999</menuBarColor>
                <rowAlternativeColor>FFFFFF</rowAlternativeColor>
                <bodyColor>FFFFFF</bodyColor>
                <rowColor>F5F5F5</rowColor>
            </layoutConfiguration>
            <authenticationConfiguration>
                <passwordAuthentication>
                    <authenticationTimeout>1</authenticationTimeout>
                    <primaryAuthServers/>
                    <secondaryAuthServer/>
                </passwordAuthentication>
            </authenticationConfiguration>
        </sslvpnConfig>
        <dns>
            <version>8</version>
            <enabled>true</enabled>
            <cacheSize>16</cacheSize>
            <listeners>
                <vnic>any</vnic>
            </listeners>
            <dnsViews>
                <dnsView>
                    <viewId>view-0</viewId>
                    <name>vsm-default-view</name>
                    <enabled>true</enabled>
                    <viewMatch>
                        <ipAddress>any</ipAddress>
                        <vnic>any</vnic>
                    </viewMatch>
                    <recursion>false</recursion>
                    <forwarders>
                        <ipAddress>10.114.214.221</ipAddress>
                        <ipAddress>10.114.214.221</ipAddress>
                    </forwarders>
                </dnsView>
            </dnsViews>
            <logging>
                <enable>true</enable>
                <logLevel>info</logLevel>
            </logging>
        </dns>
        <routing>
            <version>13</version>
            <enabled>true</enabled>
            <routingGlobalConfig>
                <ecmp>false</ecmp>
                <logging>
                    <enable>false</enable>
                    <logLevel>info</logLevel>
                </logging>
            </routingGlobalConfig>
            <staticRouting>
                <defaultRoute>
                    <vnic>2</vnic>
                    <mtu>1500</mtu>
                    <description></description>
                    <gatewayAddress>10.114.216.161</gatewayAddress>
                    <adminDistance>1</adminDistance>
                </defaultRoute>
                <staticRoutes>
                    <route>
                        <mtu>1500</mtu>
                        <description></description>
                        <type>user</type>
                        <vnic>2</vnic>
                        <network>10.114.0.0/28</network>
                        <nextHop>10.114.216.161</nextHop>
                        <adminDistance>1</adminDistance>
                    </route>
                </staticRoutes>
            </staticRouting>
            <ospf>
                <enabled>false</enabled>
                <ospfAreas>
                    <ospfArea>
                        <areaId>51</areaId>
                        <type>nssa</type>
                        <authentication>
                            <type>none</type>
                        </authentication>
                    </ospfArea>
                    <ospfArea>
                        <areaId>0</areaId>
                        <type>normal</type>
                        <authentication>
                            <type>none</type>
                        </authentication>
                    </ospfArea>
                </ospfAreas>
                <ospfInterfaces/>
                <redistribution>
                    <enabled>false</enabled>
                    <rules/>
                </redistribution>
                <gracefulRestart>true</gracefulRestart>
                <defaultOriginate>false</defaultOriginate>
            </ospf>
        </routing>
        <highAvailability>
            <enabled>false</enabled>
            <declareDeadTime>6</declareDeadTime>
            <logging>
                <enable>false</enable>
                <logLevel>info</logLevel>
            </logging>
            <security>
                <enabled>false</enabled>
            </security>
        </highAvailability>
        <syslog>
            <enabled>false</enabled>
        </syslog>
        <featureConfig/>
        <loadBalancer>
            <version>30</version>
            <enabled>true</enabled>
            <enableServiceInsertion>false</enableServiceInsertion>
            <accelerationEnabled>false</accelerationEnabled>
            <virtualServer>
                <virtualServerId>virtualServer-3</virtualServerId>
                <name>new</name>
                <enabled>true</enabled>
                <ipAddress>10.114.216.167</ipAddress>
                <protocol>http</protocol>
                <port>80</port>
                <connectionLimit>0</connectionLimit>
                <connectionRateLimit>0</connectionRateLimit>
                <defaultPoolId>pool-2</defaultPoolId>
                <applicationProfileId>applicationProfile-2</applicationProfileId>
                <enableServiceInsertion>false</enableServiceInsertion>
                <accelerationEnabled>false</accelerationEnabled>
            </virtualServer>
            <virtualServer>
                <virtualServerId>virtualServer-2</virtualServerId>
                <name>Profile</name>
                <enabled>true</enabled>
                <ipAddress>10.114.216.167</ipAddress>
                <protocol>https</protocol>
                <port>443</port>
                <connectionLimit>0</connectionLimit>
                <connectionRateLimit>0</connectionRateLimit>
                <defaultPoolId>pool-1</defaultPoolId>
                <applicationProfileId>applicationProfile-1</applicationProfileId>
                <enableServiceInsertion>false</enableServiceInsertion>
                <accelerationEnabled>false</accelerationEnabled>
            </virtualServer>
            <pool>
                <poolId>pool-1</poolId>
                <name>GoRouter-Pool</name>
                <algorithm>round-robin</algorithm>
                <transparent>false</transparent>
                <monitorId>monitor-1</monitorId>
                <member>
                    <memberId>member-1</memberId>
                    <ipAddress>172.16.90.2</ipAddress>
                    <weight>1</weight>
                    <monitorPort>443</monitorPort>
                    <port>443</port>
                    <maxConn>0</maxConn>
                    <minConn>0</minConn>
                    <condition>enabled</condition>
                    <name>GoRouter</name>
                </member>
            </pool>
            <pool>
                <poolId>pool-2</poolId>
                <name>pool-2</name>
                <algorithm>round-robin</algorithm>
                <transparent>false</transparent>
                <monitorId>monitor-1</monitorId>
                <member>
                    <memberId>member-2</memberId>
                    <ipAddress>172.16.90.2</ipAddress>
                    <weight>1</weight>
                    <monitorPort>80</monitorPort>
                    <port>80</port>
                    <maxConn>0</maxConn>
                    <minConn>0</minConn>
                    <condition>enabled</condition>
                    <name>http</name>
                </member>
            </pool>
            <applicationProfile>
                <applicationProfileId>applicationProfile-2</applicationProfileId>
                <name>application-http</name>
                <insertXForwardedFor>true</insertXForwardedFor>
                <sslPassthrough>false</sslPassthrough>
                <template>HTTP</template>
                <serverSslEnabled>false</serverSslEnabled>
            </applicationProfile>
            <applicationProfile>
                <applicationProfileId>applicationProfile-1</applicationProfileId>
                <name>Profile-HTTPS</name>
                <insertXForwardedFor>true</insertXForwardedFor>
                <sslPassthrough>false</sslPassthrough>
                <template>HTTPS</template>
                <serverSslEnabled>false</serverSslEnabled>
                <clientSsl>
                    <ciphers>DEFAULT</ciphers>
                    <clientAuth>ignore</clientAuth>
                    <serviceCertificate>certificate-16</serviceCertificate>
                </clientSsl>
            </applicationProfile>
            <monitor>
                <monitorId>monitor-1</monitorId>
                <type>tcp</type>
                <interval>5</interval>
                <timeout>15</timeout>
                <maxRetries>3</maxRetries>
                <name>default_tcp_monitor</name>
            </monitor>
            <monitor>
                <monitorId>monitor-2</monitorId>
                <type>http</type>
                <interval>5</interval>
                <timeout>15</timeout>
                <maxRetries>3</maxRetries>
                <method>GET</method>
                <url>/</url>
                <name>default_http_monitor</name>
            </monitor>
            <monitor>
                <monitorId>monitor-3</monitorId>
                <type>https</type>
                <interval>5</interval>
                <timeout>15</timeout>
                <maxRetries>3</maxRetries>
                <method>GET</method>
                <url>/</url>
                <name>default_https_monitor</name>
            </monitor>
            <logging>
                <enable>true</enable>
                <logLevel>info</logLevel>
            </logging>
        </loadBalancer>
        <gslb>
            <version>1</version>
            <enabled>false</enabled>
            <logging>
                <enable>false</enable>
                <logLevel>info</logLevel>
            </logging>
        </gslb>
        <ipsec>
            <version>1</version>
            <enabled>false</enabled>
            <logging>
                <enable>true</enable>
                <logLevel>warning</logLevel>
            </logging>
            <sites/>
            <global>
                <psk>******</psk>
                <caCertificates/>
                <crlCertificates/>
            </global>
        </ipsec>
        <dhcp>
            <version>7</version>
            <enabled>false</enabled>
            <staticBindings/>
            <ipPools/>
            <logging>
                <enable>false</enable>
                <logLevel>info</logLevel>
            </logging>
        </dhcp>
        <nat>
            <enabled>true</enabled>
            <natRules>
                <natRule>
                    <ruleId>196614</ruleId>
                    <ruleTag>196614</ruleTag>
                    <ruleType>internal_high</ruleType>
                    <action>dnat</action>
                    <vnic>2</vnic>
                    <originalAddress>10.114.216.167</originalAddress>
                    <translatedAddress>10.114.216.167</translatedAddress>
                    <loggingEnabled>false</loggingEnabled>
                    <enabled>true</enabled>
                   <description>loadBalancer</description>
                    <protocol>tcp</protocol>
                    <originalPort>443</originalPort>
                    <translatedPort>443</translatedPort>
                </natRule>
                <natRule>
                    <ruleId>196612</ruleId>
                    <ruleTag>196612</ruleTag>
                    <ruleType>internal_high</ruleType>
                    <action>dnat</action>
                    <vnic>2</vnic>
                    <originalAddress>10.114.216.167</originalAddress>
                    <translatedAddress>10.114.216.167</translatedAddress>
                    <loggingEnabled>false</loggingEnabled>
                    <enabled>true</enabled>
                    <description>loadBalancer</description>
                    <protocol>tcp</protocol>
                    <originalPort>80</originalPort>
                    <translatedPort>80</translatedPort>
                </natRule>
                <natRule>
                    <ruleId>196610</ruleId>
                    <ruleTag>196610</ruleTag>
                    <ruleType>user</ruleType>
                    <action>snat</action>
                    <originalAddress>172.16.0.0/16</originalAddress>
                    <translatedAddress>10.114.216.167</translatedAddress>
                    <loggingEnabled>true</loggingEnabled>
                    <enabled>true</enabled>
                    <description></description>
                    <protocol>any</protocol>
                    <originalPort>any</originalPort>
                    <translatedPort>any</translatedPort>
                </natRule>
                <natRule>
                    <ruleId>196611</ruleId>
                    <ruleTag>196611</ruleTag>
                    <ruleType>user</ruleType>
                    <action>dnat</action>
                    <originalAddress>10.114.216.168</originalAddress>
                    <translatedAddress>172.16.80.2</translatedAddress>
                    <loggingEnabled>true</loggingEnabled>
                    <enabled>true</enabled>
                    <description></description>
                    <protocol>any</protocol>
                    <originalPort>any</originalPort>
                    <translatedPort>any</translatedPort>
                </natRule>
            </natRules>
        </nat>
        <bridges>
            <version>7</version>
            <enabled>false</enabled>
        </bridges>
        <featureConfig/>
    </features>
    <autoConfiguration>
        <enabled>true</enabled>
        <rulePriority>high</rulePriority>
    </autoConfiguration>
    <type>gatewayServices</type>
    <isUniversal>false</isUniversal>
    <hypervisorAssist>false</hypervisorAssist>
    <queryDaemon>
        <enabled>false</enabled>
        <port>5666</port>
    </queryDaemon>
</edge>

 