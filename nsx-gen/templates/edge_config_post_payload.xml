<edge>
    <datacenterMoid>{{edge['datacenter_id']}}</datacenterMoid>
    <name>{{edge['name']}}</name>
    <description>Edge {{edge['name']}}</description>
    <tenant>default</tenant>
    <fqdn>NSX-{{edge['id']}}</fqdn>
    <vseLogLevel>EMERGENCY</vseLogLevel>
    <enableAesni>true</enableAesni>
    <enableFips>false</enableFips>
    <appliances>
        <applianceSize>{{edge['size']}}</applianceSize>
        <appliance>
            <resourcePoolId>{{edge['resourcePoolId']}}</resourcePoolId>
            <datastoreId>{{edge['datastoreId']}}</datastoreId>
            <!--
            <hostId>{{edge['hostId']}}</hostId>
            <vmFolderId>{{edge['vmFolderId']}}</vmFolderId>     
            -->       
            <cpuReservation>
                <reservation>6000</reservation>
            </cpuReservation>
            <memoryReservation>
                <reservation>8192</reservation>
            </memoryReservation>
        </appliance>
    </appliances>
    <vnics>
    <!--    
        <vnic>
            <index>0</index>
            <label>vNic_0</label>
            <name>Lif to Uplink</name>
            <type>uplink</type> 
            <portgroupId>{{ uplink['id']}}</portgroupId>
            <addressGroups>
                <addressGroup>
                    <primaryAddress>{{uplink['primary_ip']}}</primaryAddress>
                    <secondaryAddresses>
                    {% for secondary_ip in uplink['secondary_ips']%}
                    <ipAddress>{{secondary_ip}}</ipAddress>
                    {% endfor %}
                    </secondaryAddresses>                
                    <subnetMask>{{uplink['subnet_mask']}}</subnetMask>
                    <subnetPrefixLength>{{uplink['subnet_length']}}</subnetPrefixLength>
                </addressGroup>
            </addressGroups>           
            <mtu>1500</mtu>
            <enableProxyArp>false</enableProxyArp>
            <enableSendRedirects>true</enableSendRedirects>
            <isConnected>true</isConnected>
            <inShapingPolicy>
                <averageBandwidth>2000</averageBandwidth>
                <peakBandwidth>2000</peakBandwidth>
                <burstSize>0</burstSize>
                <enabled>true</enabled>
                <inherited>false</inherited>
            </inShapingPolicy>
            <outShapingPolicy>
                <averageBandwidth>2000</averageBandwidth>
                <peakBandwidth>2000</peakBandwidth>
                <burstSize>0</burstSize>
                <enabled>true</enabled>
                <inherited>false</inherited>
            </outShapingPolicy>
        </vnic>
    -->
        {% for lswitch in logical_switches %}
        <vnic>
            <index>{{ loop.index - 1}}</index>
            <label>vNic_{{ loop.index - 1}}</label>
            <name>Link to {{ lswitch['name']}}</name>
            <type>internal</type>
            <portgroupId>{{ lswitch['id']}}</portgroupId>
            <addressGroups>
                <addressGroup>
                    <primaryAddress>{{lswitch['primary_ip']}}</primaryAddress>
                    <subnetMask>{{lswitch['subnet_mask']}}</subnetMask>
                    <subnetPrefixLength>{{lswitch['subnet_length']}}</subnetPrefixLength>
                </addressGroup>
            </addressGroups>
            <mtu>1500</mtu>
            <enableProxyArp>false</enableProxyArp>
            <enableSendRedirects>false</enableSendRedirects>
            <isConnected>true</isConnected>       
        </vnic>
        {% endfor %}

        {% for index in empty_logical_switches %}
        <vnic>
            <index>{{ index }}</index>
            <label>vNic_{{ index}}</label>
            <name>vnic{{ index }}</name>
            <addressGroups/>
            <mtu>1500</mtu>
            <type>internal</type>
            <isConnected>false</isConnected>
            <enableProxyArp>false</enableProxyArp>
            <enableSendRedirects>true</enableSendRedirects>
        </vnic>
        {% endfor %}
    </vnics>
    <cliSettings>
        <userName>{{edge['cli']['username']}}</userName>
        <password>{{edge['cli']['password']}}</password>
        <remoteAccess>false</remoteAccess>
    </cliSettings>
    <autoConfiguration>
        <enabled>true</enabled>
        <rulePriority>high</rulePriority>
    </autoConfiguration>
<!--
    <dnsClient> 
        <primaryDns>{{edge['dns']['primary_ips']}}</primaryDns>
        {% for secondaryDns in edge['dns']['secondary_ips']%}
        <secondaryDns>{{secondaryDns}}</secondaryDns>
        {% endfor %}
        {% for domainName in edge['dns']['domainNames']%}
        <domainName>{{domainName}}</domainName>
        {% endfor %}
    </dnsClient>            
-->
    <queryDaemon>
        <enabled>false</enabled>
        <port>5666</port>
    </queryDaemon>

<!--
    <features>
        <firewall>
            <defaultPolicy>
                <action>accept</action>
                <loggingEnabled>true</loggingEnabled>
            </defaultPolicy>
            <rules>
                <rule>
                    <id>131074</id>
                    <ruleTag>131074</ruleTag>
                    <name>firewall</name>
                    <ruleType>internal_high</ruleType>
                    <enabled>true</enabled>
                    <loggingEnabled>false</loggingEnabled>
                    <description>firewall</description>
                    <action>accept</action>
                    <source>
                        <exclude>false</exclude>
                        <vnicGroupId>vse</vnicGroupId>
                    </source>
                </rule>
                <rule>
                    <id>131076</id>
                    <ruleTag>131076</ruleTag>
                    <name>dns</name>
                    <ruleType>internal_high</ruleType>
                    <enabled>true</enabled>
                    <loggingEnabled>false</loggingEnabled>
                    <description>dns</description>
                    <action>accept</action>
                    <source>
                        <exclude>false</exclude>
                        <vnicGroupId>internal</vnicGroupId>
                    </source>
                    <destination>
                        <exclude>false</exclude>
                        <ipAddress>172.16.80.1</ipAddress>
                        <ipAddress>172.16.90.1</ipAddress>
                    </destination>
                    <application>
                        <service>
                            <protocol>udp</protocol>
                            <port>53</port>
                            <sourcePort>any</sourcePort>
                        </service>
                        <service>
                            <protocol>tcp</protocol>
                            <port>53</port>
                            <sourcePort>any</sourcePort>
                        </service>
                    </application>
                </rule>
                <rule>
                    <id>131073</id>
                    <ruleTag>131073</ruleTag>
                    <name>default rule for ingress traffic</name>
                    <ruleType>default_policy</ruleType>
                    <enabled>true</enabled>
                    <loggingEnabled>true</loggingEnabled>
                    <description>default rule for ingress traffic</description>
                    <action>accept</action>
                </rule>
            </rules>
        </firewall>
        <routing>
            <version>13</version>
            <enabled>true</enabled>
            <routingGlobalConfig>
                <ecmp>false</ecmp>
                <logging>
                    <enable>false</enable>
                    <logLevel>info</logLevel>
                </logging>
            </routingGlobalConfig>
            <staticRouting>
                <defaultRoute>
                    <vnic>2</vnic>
                    <mtu>1500</mtu>
                    <description></description>
                    <gatewayAddress>10.114.216.161</gatewayAddress>
                    <adminDistance>1</adminDistance>
                </defaultRoute>
                <staticRoutes>
                    <route>
                        <mtu>1500</mtu>
                        <description></description>
                        <type>user</type>
                        <vnic>2</vnic>
                        <network>10.114.0.0/28</network>
                        <nextHop>10.114.216.161</nextHop>
                        <adminDistance>1</adminDistance>
                    </route>
                </staticRoutes>
            </staticRouting>
            <ospf>
                <enabled>false</enabled>
                <ospfAreas>
                    <ospfArea>
                        <areaId>51</areaId>
                        <type>nssa</type>
                        <authentication>
                            <type>none</type>
                        </authentication>
                    </ospfArea>
                    <ospfArea>
                        <areaId>0</areaId>
                        <type>normal</type>
                        <authentication>
                            <type>none</type>
                        </authentication>
                    </ospfArea>
                </ospfAreas>
                <ospfInterfaces/>
                <redistribution>
                    <enabled>false</enabled>
                    <rules/>
                </redistribution>
                <gracefulRestart>true</gracefulRestart>
                <defaultOriginate>false</defaultOriginate>
            </ospf>
        </routing>
        <dns>
            <enabled>true</enabled>
            <cacheSize>16</cacheSize>
            <listeners>
                <vnic>any</vnic>
            </listeners>
            <dnsViews>
                <dnsView>
                    <viewId>view-0</viewId>
                    <name>vsm-default-view</name>
                    <enabled>true</enabled>
                    <viewMatch>
                        <ipAddress>any</ipAddress>
                        <vnic>any</vnic>
                    </viewMatch>
                    <recursion>false</recursion>
                    <forwarders>
                        <ipAddress>10.114.214.221</ipAddress>
                        <ipAddress>10.114.214.221</ipAddress>
                    </forwarders>
                </dnsView>
            </dnsViews>
            <logging>
                <enable>true</enable>
                <logLevel>info</logLevel>
            </logging>
        </dns>
        <highAvailability>
            <enabled>false</enabled>
            <declareDeadTime>6</declareDeadTime>
            <logging>
                <enable>false</enable>
                <logLevel>info</logLevel>
            </logging>
            <security>
                <enabled>false</enabled>
            </security>
        </highAvailability>
        <syslog>
            <enabled>false</enabled>
        </syslog>
        <featureConfig/>

        <gslb>
            <version>1</version>
            <enabled>false</enabled>
            <logging>
                <enable>false</enable>
                <logLevel>info</logLevel>
            </logging>
        </gslb>
        <ipsec>
            <version>1</version>
            <enabled>false</enabled>
            <logging>
                <enable>true</enable>
                <logLevel>warning</logLevel>
            </logging>
            <sites/>
            <global>
                <psk>******</psk>
                <caCertificates/>
                <crlCertificates/>
            </global>
        </ipsec>
        <dhcp>
            <version>7</version>
            <enabled>false</enabled>
            <staticBindings/>
            <ipPools/>
            <logging>
                <enable>false</enable>
                <logLevel>info</logLevel>
            </logging>
        </dhcp>
        <nat>
            <enabled>true</enabled>
            <natRules>
                <natRule>
                    <ruleId>196614</ruleId>
                    <ruleTag>196614</ruleTag>
                    <ruleType>internal_high</ruleType>
                    <action>dnat</action>
                    <vnic>2</vnic>
                    <originalAddress>10.114.216.167</originalAddress>
                    <translatedAddress>10.114.216.167</translatedAddress>
                    <loggingEnabled>false</loggingEnabled>
                    <enabled>true</enabled>
                   <description>loadBalancer</description>
                    <protocol>tcp</protocol>
                    <originalPort>443</originalPort>
                    <translatedPort>443</translatedPort>
                </natRule>
                <natRule>
                    <ruleId>196612</ruleId>
                    <ruleTag>196612</ruleTag>
                    <ruleType>internal_high</ruleType>
                    <action>dnat</action>
                    <vnic>2</vnic>
                    <originalAddress>10.114.216.167</originalAddress>
                    <translatedAddress>10.114.216.167</translatedAddress>
                    <loggingEnabled>false</loggingEnabled>
                    <enabled>true</enabled>
                    <description>loadBalancer</description>
                    <protocol>tcp</protocol>
                    <originalPort>80</originalPort>
                    <translatedPort>80</translatedPort>
                </natRule>
                <natRule>
                    <ruleId>196610</ruleId>
                    <ruleTag>196610</ruleTag>
                    <ruleType>user</ruleType>
                    <action>snat</action>
                    <originalAddress>172.16.0.0/16</originalAddress>
                    <translatedAddress>10.114.216.167</translatedAddress>
                    <loggingEnabled>true</loggingEnabled>
                    <enabled>true</enabled>
                    <description></description>
                    <protocol>any</protocol>
                    <originalPort>any</originalPort>
                    <translatedPort>any</translatedPort>
                </natRule>
                <natRule>
                    <ruleId>196611</ruleId>
                    <ruleTag>196611</ruleTag>
                    <ruleType>user</ruleType>
                    <action>dnat</action>
                    <originalAddress>10.114.216.168</originalAddress>
                    <translatedAddress>172.16.80.2</translatedAddress>
                    <loggingEnabled>true</loggingEnabled>
                    <enabled>true</enabled>
                    <description></description>
                    <protocol>any</protocol>
                    <originalPort>any</originalPort>
                    <translatedPort>any</translatedPort>
                </natRule>
            </natRules>
        </nat>
        <bridges>
            <version>7</version>
            <enabled>false</enabled>
        </bridges>
        <featureConfig/>
    </features>
     <type>gatewayServices</type>
    <isUniversal>false</isUniversal>
    <hypervisorAssist>false</hypervisorAssist>
  -->

</edge>

 